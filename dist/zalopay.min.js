
/*! zalopay 09-06-2017 */
(function(a,b){if(typeof module!=="undefined"&&module.exports){module.exports=b()}else{if(typeof define==="function"&&(define.amd||define.cmd)){define(b)}else{a.ant=a.ZaloPay=a.ZaloPay||{};b.call(a,a.ZaloPay)}}}(this,function(e){e=e||{};e.ua=navigator.userAgent;e.jsVersion="1.0.0";e.isDebug=true;e.isZaloPay=(function(){return(e.ua.indexOf("ZaloPayClient")>-1)})();if(!e.isZaloPay){j("warn","Run in ZaloPayClient please!")}e.appVersion=(function(){if(e.isZaloPay){var m=e.ua.match(/ZaloPayClient\/(.*)/);return(m&&m.length)?m[1]:""}})();e.appInfo={name:"ZaloPay",isZaloPay:e.isZaloPay,jsVersion:e.jsVersion,appVersion:e.appVersion};e.on=function(n,m){n.split(/\s+/g).forEach(function(o){document.addEventListener(o,m,false)})};e.call=function(){var p=[].slice.call(arguments);if(window.ZaloPayJSBridge&&window.ZaloPayJSBridge.call){var o=p[0],q=p[1]||{},n=p[2];if(!f(o)){j("error","ZaloPay.call","Request undefined function!");return}if(n===undefined&&d(q)){n=q;q={}}if(!a(q)){j("error","ZaloPay.call","Request undefined options!");return}var m=n;n=function(r){r=c(r,o);m&&m(r)};"writeLog"!==o&&j("info","ZaloPayJSBridge.call",o,q,m);window.ZaloPayJSBridge.call(o,q,n)}else{e._apiQueue=e._apiQueue||[];e._apiQueue.push(p)}};e._ready=function(m){if(window.ZaloPayJSBridge&&window.ZaloPayJSBridge.call){m&&m()}else{e.on("ZaloPayJSBridgeReady",m)}};e.ready=e.ready||e._ready;e.showLoading=function(){e.call("showLoading")};e.hideLoading=function(){e.call("hideLoading")};e.closeWindow=function(){e.call("closeWindow")};e.showDialog=function(m){if(!a(m)){j("error","ZaloPay.showDialog","Received invalid object");return}if(f(m.title)&&f(m.message)&&f(m.button)){m={type:2,title:m.title,message:m.message,button:m.button};e.call("showDialog",m)}};e.pushView=function(m){if(!a(m)){j("error","ZaloPay.pushView","Received invalid object");return}if(f(m.url)){m={url:m.url};e.call("pushView",m);return}j("error","ZaloPay.pushView","Received missing require param!")};e.payOrder=function(n,m){if(!a(n)){j("error","ZaloPay.payOrder","Received invalid object");return}if(f(n.zptranstoken)){n={zptranstoken:n.zptranstoken,appid:n.appid};j("info","ZaloPay.payOrder","Received zptranstoken",n);e.call("payOrder",n,m);return}else{if(f(n.mac)){n={appid:n.appid,appuser:n.appuser,apptime:n.apptime,amount:n.amount,apptransid:n.apptransid,embeddata:n.embeddata,item:n.item,description:n.description,mac:n.mac};j("info","ZaloPay.payOrder","Received transinfo",n);e.call("payOrder",n,m);return}}j("error","ZaloPay.payOrder","Received missing require param!")};e.transferMoney=function(n,m){if(!a(n)){j("error","ZaloPay.transferMoney","Received invalid object");return}if(f(n.zpid)&&f(n.message)&&l(n.amount)){n={zpid:n.zpid,amount:n.amount,message:n.message};j("info","ZaloPay.transferMoney","Received transferMoney",n);e.call("transferMoney",n,m);return}j("error","ZaloPay.transferMoney","Received missing require param!")};e.promotionEvent=function(m){if(!a(m)){j("error","ZaloPay.promotionEvent","Received invalid object");return}if(l(m.campaignId)&&l(m.internalApp)){m={campaignId:m.campaignId,internalApp:m.internalApp,alternateUrl:m.alternateUrl};j("info","ZaloPay.promotionEvent","Received promotionEvent",m);e.call("promotionEvent",m);return}else{if(l(m.campaignId)&&f(m.url)&&f(m.packageId)){m={campaignId:m.campaignId,url:m.url,packageId:m.packageId,alternateUrl:m.alternateUrl};j("info","ZaloPay.promotionEvent","Received promotionEvent",m);e.call("promotionEvent",m);return}}j("error","ZaloPay.transferMoney","Received missing require param!",m)};e.setProperty=function(n,m){if(!a(n)){j("error","ZaloPay.setProperty","Received invalid object");return}j("info","ZaloPay.setProperty","Received navigator",n);if(d(m)){e.call("setProperty",n,m)}else{e.call("setProperty",n)}return};e.setToolbarActions=function(o,m){if(!b(o)||o.length<1||!d(m)){j("error","ZaloPay.setToolbarActions","Received invalid object");return}var n=[];o.forEach(function(q,p){if(f(q.iconId)){if(f(q.iconLink)){n.push({iconId:q.iconId,func:m.name,iconLink:q.iconLink,iconName:"",iconColor:""})}else{if(f(q.iconName)){if(f(q.iconColor)){n.push({iconId:q.iconId,func:m.name,iconLink:"",iconName:q.iconName,iconColor:q.iconColor})}else{n.push({iconId:q.iconId,func:m.name,iconLink:"",iconName:q.iconName,iconColor:""})}}}}});if(n.length>0){e.call("setToolbarActions",{data:n});document.addEventListener(m.name,m,false);return}j("error","ZaloPay.setToolbarActions","Received missing require param!",o)};e.requestAnimationFrame=function(m){var n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;if(n){return n(m)}else{j("error","ZaloPay.requestAnimationFrame","Not supported!")}};e._ready(function(){j("info","ZaloPayJS Ready!");var n=e._apiQueue||[];function m(){e.requestAnimationFrame(function(){var o=n.shift();e.call.apply(null,o);if(n.length){m()}})}!!n.length&&m()});(["appinfo","showLoading","hideLoading","closeWindow","showDialog","pushView"]).forEach(function(m){e[m]=function(){var n=[].slice.call(arguments);e.call.apply(null,([m]).concat(n))}});function g(){return(/android/i).test(e.ua)}function h(){return(/iphone|ipad|ipod/i).test(e.ua)}function b(m){return"array"===i(m)}function d(m){return"function"===i(m)}function f(m){return"string"===i(m)}function a(m){return"object"===i(m)}function l(m){return"number"===i(m)}function i(m){return Object.prototype.toString.call(m).replace(/\[object (\w+)\]/,"$1").toLowerCase()}function j(){var p=(+new Date());var m=[].slice.call(arguments);var o=m[0].toLowerCase().trim();switch(o){case"error":m.splice(0,1);m.length===1?console.error(p,m[0]):console.error(p,m);break;case"warn":m.splice(0,1);m.length===1?console.warn(p,m[0]):console.warn(p,m);break;case"info":m.splice(0,1);m.length===1?console.log(p,m[0]):console.log(p,m);break;default:o="info";m.length===1?console.log(p,m[0]):console.log(p,m);break}if(e.isDebug&&e.call&&window.ZaloPayJSBridge&&window.ZaloPayJSBridge.call){var n={type:o,time:p,data:JSON.stringify(m)};e.call("writeLog",n)}}function c(m,n){m=m||{};m.errorCode=m.error||0;if(m.error!==1){j("error",n+": errorCode["+m.errorCode+"], message["+m.errorMessage+"]")}else{j("info",n+": errorCode["+m.errorCode+"], message["+m.errorMessage+"]")}return m}function k(m){var n=e.appVersion.split(".");m=m.split(".");for(var p=0,q,o;p<n.length;p++){q=parseInt(m[p],10)||0;o=parseInt(n[p],10)||0;if(q>o){return -1}if(q<o){return 1}}return 0}return e}));